radiant::radiant()
# Load featured data
df <- readRDS("datasets/pro/psych_visits_featured.rds")
features <- readRDS("datasets/pro/psych_features.rds")
# Data Overview
skim(df)
#| results: hide
# Packages
packages <- c("DT",
"DataExplorer",
"caret",
"corrplot",
"dplyr",
"forcats",
"ggplot2",
"hms",
"janitor",
"knitr",
"lubridate",
"pROC",
"purrr",
"randomForest",
"ranger",
"skimr",
"stringr",
"tidyr",
"timeDate")
#|results: hide
# Install packages
for (package in packages) {
if (!requireNamespace(package, quietly = TRUE)) {
install.packages(package)}}
#| results: hide
# Load packages
lapply(packages, library, character.only = TRUE)
---
title: "PURPOSe: Predicting Utilization of Resources in Psychiatry Outpatient Services"
---
title: "PURPOSe: Predicting Utilization of Resources in Psychiatry Outpatient Services"
#| results: hide
# Packages
packages <- c("DT",
"DataExplorer",
"caret",
"corrplot",
"dplyr",
"forcats",
"ggplot2",
"hms",
"janitor",
"knitr",
"lubridate",
"pROC",
"purrr",
"randomForest",
"ranger",
"skimr",
"stringr",
"tidyr",
"timeDate")
---
title: "PURPOSe"
# Load required packages
library(dplyr)  # for data manipulation
# Read all data frames and store in a named list
df_list <- list(
raw_visits  = readRDS("datasets/visits_anon.rds"),
clean_visits = readRDS("datasets/visits_clean.rds"),
psych_visits = readRDS("datasets/sub/psych_visits.rds"),
psych_patients = readRDS("datasets/sub/psych_patients.rds")
)
# Generate summary table
summary_table <- bind_rows(lapply(names(df_list), function(n) {
df <- df_list[[n]]
tibble(
dataset = n,
obs = nrow(df),
vars = ncol(df),
distinct_ids = n_distinct(df$patient_id)
)
}))
print(summary_table)
# Save current package versions to renv.lock
renv::snapshot()
# Install and initialize renv from scratch if needed
# (Ensures reproducible environment)
if (!requireNamespace("renv", quietly = TRUE)) {
install.packages("renv", repos = "https://cloud.r-project.org")
}
library(renv)
Sys.setenv(RENV_CONSENT = "yes")
if (!file.exists("renv.lock")) {
renv::init(bare = TRUE)
} else {
renv::activate()
}
# Install and initialize renv from scratch if needed
# (Ensures reproducible environment)
if (!requireNamespace("renv", quietly = TRUE)) {
install.packages("renv", repos = "https://cloud.r-project.org")
}
library(renv)
Sys.setenv(RENV_CONSENT = "yes")
if (!file.exists("renv.lock")) {
renv::init(bare = TRUE)
} else {
renv::activate()
}
install.packages("summarytools")
setwd("~/repos/inbasketosis")
clean <- readRDS("~/repos/inbasketosis/data/clean.rds")
View(clean)
library(dplyr)
filtered <- clean |> filter(!anyNA)
filtered <- clean |> select(!anyNA)
filtered <- clean |> filter(!is.na(c_across(starts_with(c("24-", "25-")))))
filtered <- clean |> filter(!is.na(c_across(starts_with(c("24-", "25-")))))
filtered <- clean |> filter(rowSums(!is.na(select(., starts_with(c("24-", "25-"))))) > 0)
full_data <- clean |>
filter(rowSums(!is.na(select(., starts_with(c("24-", "25-"))))) > 0)
filtered <- clean |>
filter(anyNA() == FALSE)
filtered <- clean |> select(starts_with(c("24-", "25-"))) |>  filter(anyNA() == FALSE)
filtered <- clean |>
filter(across(starts_with(c("24-", "25-")), ~ !is.na(.)))
filtered <- clean |>
filter(if_any(starts_with(c("24-", "25-")), ~ !is.na(.)))
View(filtered)
filtered <- na.omit(clean)
View(filtered)
n_distinct(filtered$id)
filtered |> group_by(id) |> nrow()
filtered |> group_by(id) |> summarise(nrow())
filtered |> group_by(id) |> summarise(nrow
)
